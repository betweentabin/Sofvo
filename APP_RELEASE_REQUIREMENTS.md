# Sofvo アプリリリース要件書

## 📱 アプリ概要
**アプリ名**: Sofvo（ソフボ）  
**カテゴリ**: スポーツ・コミュニティ  
**プラットフォーム**: iOS / Android  
**対象ユーザー**: スポーツ大会参加者、チーム運営者、スポーツコミュニティ  

## 🎯 コア機能要件

### 1. ユーザー管理
- [x] ユーザー登録・ログイン機能
- [x] プロフィール作成・編集
- [x] パスワードリセット
- [x] ログアウト機能
- [ ] ソーシャルログイン（Google/Apple）
- [ ] メールアドレス認証

### 2. ソーシャル機能
- [x] フォロー/フォロワー機能
- [x] タイムライン（フォロー中/おすすめ）
- [x] 投稿機能（テキスト投稿）
- [ ] いいね機能の完全実装
- [ ] コメント機能
- [ ] 投稿の削除・編集
- [ ] 画像・動画投稿

### 3. 大会管理
- [x] 大会検索機能
- [x] 大会詳細表示
- [x] 大会スケジュール表示
- [ ] 大会作成・編集機能
- [ ] 大会参加申込機能
- [ ] 大会結果入力・表示
- [ ] トーナメント表生成
- [ ] 参加費決済機能

### 4. チーム管理
- [x] チーム作成UI
- [x] メンバー管理UI
- [ ] チーム作成API実装
- [ ] メンバー招待機能
- [ ] チーム内チャット
- [ ] チーム統計・成績管理
- [ ] チームカレンダー

### 5. コミュニケーション
- [x] DM（ダイレクトメッセージ）機能
- [x] リアルタイムチャット
- [x] 通知機能UI
- [ ] プッシュ通知実装
- [ ] 既読機能
- [ ] グループチャット
- [ ] 通知設定カスタマイズ

### 6. その他機能
- [x] お問い合わせフォーム
- [x] 利用規約・プライバシーポリシー
- [ ] アプリ内課金（プレミアム機能）
- [ ] 広告表示システム
- [ ] データエクスポート機能

## 🔧 技術要件

### フロントエンド
- [x] React 18 + Vite
- [x] レスポンシブデザイン
- [x] React Router（SPAルーティング）
- [x] Capacitorによるネイティブ機能統合
- [ ] PWA対応
- [ ] オフライン対応
- [ ] パフォーマンス最適化（コード分割、遅延読み込み）

### バックエンド
- [x] Supabase認証システム
- [x] PostgreSQLデータベース
- [x] リアルタイム通信（WebSocket）
- [ ] Node.js APIの完全実装
- [ ] ファイルアップロード機能
- [ ] キャッシュシステム
- [ ] レート制限実装

### インフラ・デプロイ
- [x] Supabaseセットアップ
- [ ] 本番環境構築
- [ ] CI/CDパイプライン
- [ ] 監視・ログシステム
- [ ] バックアップ体制
- [ ] CDN設定

### 環境変数・シークレット管理（追記）
- [ ] 本番用`.env.production`の用意（フロント）
- [ ] バックエンド用環境変数の安全管理（環境/Vault/Secret Manager）
- [ ] Supabase ANON/SERVICE KEYのローテーション（リポジトリからの秘匿）
- [ ] FCM_SERVER_KEY（Edge Functions）の登録（Supabase Secrets）
- [ ] App Store Connect API Key / Google Play Service Account JSON（CI用）
- [ ] Android keystore（安全保管・バックアップ）/ iOS 配布証明書・プロファイル

## 📊 データベース要件

### 必須テーブル（実装済み）
- [x] users（ユーザー）
- [x] profiles（プロフィール）
- [x] teams（チーム）
- [x] tournaments（大会）
- [x] messages（メッセージ）
- [x] notifications（通知）

### 追加必要テーブル
- [ ] payment_transactions（決済）
- [ ] app_settings（アプリ設定）
- [ ] reports（通報）
- [ ] analytics（分析データ）

## 🔒 セキュリティ要件

### 認証・認可
- [x] JWT認証
- [x] Row Level Security (RLS)
- [ ] 二要素認証
- [ ] セッション管理強化
- [ ] APIレート制限

### データ保護
- [x] HTTPS通信
- [ ] データ暗号化
- [ ] 個人情報マスキング
- [ ] GDPRコンプライアンス
- [ ] データ削除機能

### シークレット/鍵管理（追記）
- [ ] リポジトリに秘密情報を含めない（環境変数・接続文字列の除去）
- [ ] すでにコミット済みの秘密情報のローテーション（DB/キー類）
- [ ] Android keystoreの安全保管（複製/保管手順）
- [ ] iOS 証明書/プロファイルの管理（担当者/更新日）

## 📱 モバイルアプリ要件

### iOS
- [ ] iOS 14.0以上対応
- [ ] App Store審査対策
- [ ] TestFlight配信準備
- [ ] プッシュ通知証明書
- [ ] App Store Connect設定
- [ ] Capabilities設定（Push Notifications, Background Modes: Remote notifications）
- [ ] App Privacy（データの収集・追跡に関する申告）
- [ ] ATT（App Tracking Transparency）対応（トラッキングを行う場合）
- [ ] Info.plistのUsageDescription整備（通知/カメラ/写真/位置情報 等）
- [ ] バージョン/ビルド番号運用ルール（CFBundleShortVersionString / CFBundleVersion）

### Android
- [ ] Android 7.0以上対応
- [ ] Google Play審査対策
- [ ] 内部テスト配信準備
- [ ] Firebase設定
- [ ] Google Play Console設定
- [ ] Data safetyフォームの提出（収集/共有データの申告）
- [ ] App signing（Google Play アプリ署名）/ keystore管理
- [ ] `POST_NOTIFICATIONS`権限および通知チャンネル設定
- [ ] minSdk/targetSdkの整合（minSdk >= 24: Android 7.0）
- [ ] バージョンコード/バージョン名運用ルール（versionCode / versionName）

### 共通
- [x] Capacitor設定
- [ ] アプリアイコン（全サイズ）
- [ ] スプラッシュスクリーン
- [ ] アプリ内課金設定
- [ ] クラッシュレポート
- [ ] ディープリンク/ユニバーサルリンク（通知/共有からの遷移）
- [ ] ローカライゼーション（日本語既定、ストア文言揃え）
- [ ] ストア用メタデータ（説明/スクショ/ポリシーURL/サポート）整備
- [ ] 端末パーミッションの文言・挙動レビュー（iOS/Android）
- [ ] 署名・証明書の期限管理（更新フロー）

## 🧪 テスト要件

### 機能テスト
- [ ] ユニットテスト
- [ ] 統合テスト
- [ ] E2Eテスト
- [ ] 手動テストシナリオ

### 配信・受け入れテスト（追記）
- [ ] TestFlight内部テスト（iOS）テスターアカウント準備
- [ ] Google Play内部テスト（Android）テスターリスト準備
- [ ] プッシュ通知（FG/BG/終了時）動作確認
- [ ] Deep Link/起動パラメータの遷移確認

### 非機能テスト
- [ ] パフォーマンステスト
- [ ] セキュリティテスト
- [ ] 負荷テスト
- [ ] ユーザビリティテスト

## 📈 パフォーマンス要件

- [ ] 初期読み込み: 3秒以内
- [ ] API応答時間: 1秒以内
- [ ] リアルタイム通信遅延: 500ms以内
- [ ] 同時接続ユーザー: 1,000人以上
- [ ] データベース応答: 100ms以内

## 🎨 UI/UX要件

- [x] モバイルファースト設計
- [x] 日本語完全対応
- [ ] ダークモード対応
- [ ] アクセシビリティ対応
- [ ] ローディング状態表示
- [ ] エラーハンドリング改善
- [ ] アニメーション追加

## 📝 ドキュメント要件

- [ ] APIドキュメント
- [ ] データベース設計書
- [ ] 運用マニュアル
- [ ] ユーザーガイド
- [ ] 利用規約（最終版）
- [ ] プライバシーポリシー（最終版）
- [ ] App Privacy（Apple）/ Data safety（Google）提出用回答集
- [ ] OSSライセンス表記一覧（使用ライブラリの著作権/ライセンス明記）
- [ ] 運用Runbook（障害/連絡/エスカレーション/鍵復旧手順）

## 🚀 リリース前チェックリスト

### 開発完了
- [ ] 全必須機能の実装完了
- [ ] バグ修正完了
- [ ] コードレビュー実施
- [ ] テスト完了（カバレッジ80%以上）

### 設定整合チェック（追記）
- [ ] iOS Deployment Target = 14.0（Xcodeプロジェクト）
- [ ] Android minSdkVersion >= 24（現在: 23 → 要引き上げ）
- [ ] HashRouter使用/`base: "./"`設定（Vite）
- [ ] index.htmlのCSPが本番API/Realtimeに適合
- [ ] 本番用API URL・Supabase URL/Keyの適用確認

### 法務・コンプライアンス
- [ ] 利用規約の法務確認
- [ ] プライバシーポリシーの確認
- [ ] 特定商取引法対応（必要な場合）
- [ ] 個人情報保護方針策定
- [ ] Apple App Privacy回答/レビュー
- [ ] Google Play Data safety/コンテンツレーティング回答

### マーケティング準備
- [ ] App Store最適化（ASO）
- [ ] スクリーンショット作成
- [ ] プロモーション動画
- [ ] プレスリリース準備
- [ ] SNSアカウント開設

### 運用準備
- [ ] サポート体制構築
- [ ] 問い合わせ対応フロー
- [ ] 監視・アラート設定
- [ ] バックアップ・復旧手順
- [ ] インシデント対応計画
- [ ] クラッシュレポート（Crashlytics/Sentry）設定・DSN/鍵登録
- [ ] 監視ダッシュボード（メトリクス/ログ）作成
- [ ] 署名鍵・証明書の保全/権限管理

## 📅 推奨リリーススケジュール

### フェーズ1: MVP完成（1-2ヶ月）
- 必須機能の実装完了
- 基本的なテスト実施
- ベータ版リリース

### フェーズ2: ベータテスト（2-3週間）
- 限定ユーザーでのテスト
- フィードバック収集
- バグ修正・改善

### フェーズ3: 本番リリース準備（2週間）
- ストア審査提出
- マーケティング準備
- 本番環境最終確認

### フェーズ4: 正式リリース
- App Store / Google Play公開
- マーケティング活動開始
- ユーザーサポート開始

## 🎯 優先度設定

### 🔴 最優先（リリース必須）
1. ユーザー認証・プロフィール機能
2. 大会検索・表示機能
3. 基本的なチャット機能
4. セキュリティ対策
5. ストア審査対応
6. 秘密情報の除去とローテーション（漏洩対策）
7. 署名・証明書/keystoreの整備

### 🟡 高優先度（早期実装推奨）
1. 大会作成・管理機能
2. チーム機能の完全実装
3. プッシュ通知
4. パフォーマンス最適化

### 🟢 中優先度（段階的実装）
1. 高度なソーシャル機能
2. 決済機能
3. 分析機能
4. 広告システム

## 💰 概算コスト

### 開発コスト
- フロントエンド完成: 済
- バックエンド完成: 100-200万円
- テスト・品質保証: 50-100万円
- デザイン調整: 20-50万円

### 運用コスト（月額）
- Supabase: $25-$599
- サーバー（Railway等）: $20-$100
- CDN・ストレージ: $10-$50
- 監視・分析ツール: $50-$200

### その他
- ストア登録費: 
  - iOS: $99/年
  - Android: $25（初回のみ）
- SSL証明書: $0-$200/年
- ドメイン: $1,000-$5,000/年

## 📞 サポート体制

### カスタマーサポート
- [ ] FAQ作成
- [ ] チャットボット導入
- [ ] メールサポート体制
- [ ] 電話サポート（オプション）

### 技術サポート
- [ ] バグトラッキングシステム
- [ ] 定期メンテナンス計画
- [ ] アップデート計画
- [ ] 障害対応体制

## ⚠️ リスクと対策

### 技術的リスク
- **リスク**: スケーラビリティ問題
- **対策**: 負荷テスト実施、オートスケーリング設定

### セキュリティリスク
- **リスク**: 個人情報漏洩
- **対策**: 暗号化、定期的セキュリティ監査
- **リスク**: 秘密情報のコミット（例: DB接続文字列）
- **対策**: 直ちにキーをローテーションし、環境変数へ移行

### ビジネスリスク
- **リスク**: ユーザー獲得の遅れ
- **対策**: マーケティング戦略の事前策定

## 🏁 成功指標（KPI）

### リリース3ヶ月後
- ダウンロード数: 10,000以上
- アクティブユーザー: 3,000以上
- 大会登録数: 100以上
- チーム登録数: 500以上

### リリース6ヶ月後
- ダウンロード数: 50,000以上
- アクティブユーザー: 15,000以上
- 大会登録数: 500以上
- 収益化開始

---

最終更新日: 2025年9月26日  
バージョン: 1.0.0

# å¤§ä¼šæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚¬ã‚¤ãƒ‰

## ğŸ“‹ ãƒ†ã‚¹ãƒˆå¯¾è±¡æ©Ÿèƒ½
1. âœ… **å¤§ä¼šé–‹å‚¬æ©Ÿèƒ½** - å¤§ä¼šã®ä½œæˆã¨ç®¡ç†
2. âœ… **é€šçŸ¥æ©Ÿèƒ½** - é–‹å‚¬å‰æ—¥ã®è‡ªå‹•é€šçŸ¥
3. âœ… **å¯¾æˆ¦è¡¨ä½œæˆæ©Ÿèƒ½** - å®šå“¡åˆ°é”æ™‚ãƒ»ç· åˆ‡æ—¥ã§ã®è‡ªå‹•ç”Ÿæˆ

---

## ğŸŒ ãƒ†ã‚¹ãƒˆç’°å¢ƒ

### æœ¬ç•ªç’°å¢ƒï¼ˆæ¨å¥¨ï¼‰
- URL: **https://1a43afb3.sofvo.pages.dev**
- ã¾ãŸã¯: **https://sofvo.pages.dev**
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹: Cloudflare D1ï¼ˆæœ¬ç•ªï¼‰

### ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ
```bash
cd /Users/kuwatataiga/Sofvo
npm run dev
```
- URL: http://localhost:5173
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹: Railway PostgreSQL

---

## ğŸš€ ãƒ†ã‚¹ãƒˆæº–å‚™

### 1. ãƒ­ã‚°ã‚¤ãƒ³
1. https://1a43afb3.sofvo.pages.dev ã‚’é–‹ã
2. ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ï¼ˆã¾ãŸã¯æ–°è¦ä½œæˆï¼‰
3. ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ã‚’å…¥åŠ›

### 2. ãƒ–ãƒ©ã‚¦ã‚¶é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã‚’é–‹ã
- Chrome/Edge: `F12` ã¾ãŸã¯ `Cmd+Option+I` (Mac)
- Safari: `Cmd+Option+C`
- **Consoleã‚¿ãƒ–** ã‚’è¡¨ç¤º

### 3. ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’ç¢ºèª
ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§å®Ÿè¡Œï¼š
```javascript
const user = JSON.parse(localStorage.getItem('user'));
console.log('ãƒ­ã‚°ã‚¤ãƒ³ä¸­ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼:', user);
console.log('User ID:', user.id);
console.log('Username:', user.username);
```

---

## ğŸ“ ãƒ†ã‚¹ãƒˆ1: å¤§ä¼šé–‹å‚¬æ©Ÿèƒ½

### ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª
æ–°ã—ã„å¤§ä¼šã‚’ä½œæˆã—ã€æ­£å¸¸ã«ä¿å­˜ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

### æ‰‹é †

#### ã‚¹ãƒ†ãƒƒãƒ—1: å¤§ä¼šä½œæˆç”»é¢ã«ç§»å‹•
1. ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€Œå¤§ä¼šã‚’ä¸»å‚¬ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ãƒ•ã‚©ãƒ¼ãƒ ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

#### ã‚¹ãƒ†ãƒƒãƒ—2: å¤§ä¼šæƒ…å ±ã‚’å…¥åŠ›
```
- å¤§ä¼šå: ãƒ†ã‚¹ãƒˆå¤§ä¼š 2025
- ã‚«ãƒ†ã‚´ãƒª: ãƒãƒ¬ãƒ¼ãƒœãƒ¼ãƒ«
- ç«¶æŠ€æ–¹æ³•: ãƒªãƒ¼ã‚°æˆ¦
- é †ä½æ±ºå®šæ–¹æ³•: å‹ã¡ç‚¹åˆ¶
- é–‹å‚¬æ—¥: 2025-12-15
- å ´æ‰€: æ±äº¬éƒ½
- ä¼šå ´: ä½“è‚²é¤¨A
- ä½æ‰€: æ±äº¬éƒ½æ¸‹è°·åŒº
- å®šå“¡: 4ãƒãƒ¼ãƒ 
- ç”³è¾¼ç· åˆ‡æ—¥: 2025-12-10
```

#### ã‚¹ãƒ†ãƒƒãƒ—3: å¤§ä¼šã‚’ä½œæˆ
1. ã€Œä½œæˆã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ã€Œå¤§ä¼šã‚’ä½œæˆã—ã¾ã—ãŸï¼ã€ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèª
3. ä¸»å‚¬å¤§ä¼šç®¡ç†ç”»é¢ã«é·ç§»

#### ã‚¹ãƒ†ãƒƒãƒ—4: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§ç¢ºèª
ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§å®Ÿè¡Œï¼š
```javascript
// è‡ªåˆ†ãŒä¸»å‚¬ã—ãŸå¤§ä¼šã‚’å–å¾—
const user = JSON.parse(localStorage.getItem('user'));
const response = await fetch(`/api/railway-tournaments/my-hosted?as_user=${user.id}`);
const tournaments = await response.json();
console.table(tournaments.map(t => ({
  å¤§ä¼šå: t.name,
  é–‹å‚¬æ—¥: t.start_date,
  å ´æ‰€: t.location,
  çŠ¶æ…‹: t.status,
  ä½œæˆæ—¥: new Date(t.created_at).toLocaleString('ja-JP')
})));
```

### âœ… æˆåŠŸåŸºæº–
- [x] å¤§ä¼šãŒæ­£å¸¸ã«ä½œæˆã•ã‚Œã‚‹
- [x] ä¸»å‚¬å¤§ä¼šä¸€è¦§ã«è¡¨ç¤ºã•ã‚Œã‚‹
- [x] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹
- [x] ã™ã¹ã¦ã®å…¥åŠ›æƒ…å ±ãŒæ­£ã—ãä¿å­˜ã•ã‚Œã¦ã„ã‚‹

---

## ğŸ‘¥ ãƒ†ã‚¹ãƒˆ2: ãƒãƒ¼ãƒ ã§å¤§ä¼šã«å‚åŠ 

### å‰ææ¡ä»¶
- ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒãƒ¼ãƒ ã«æ‰€å±ã—ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™

### æº–å‚™: ãƒãƒ¼ãƒ ã‚’ä½œæˆï¼ˆæ‰€å±ã—ã¦ã„ãªã„å ´åˆï¼‰
1. ã€Œãƒãƒ¼ãƒ ä½œæˆã€ç”»é¢ã«ç§»å‹•
2. ãƒãƒ¼ãƒ åã‚’å…¥åŠ›ï¼ˆä¾‹: ãƒ†ã‚¹ãƒˆãƒãƒ¼ãƒ Aï¼‰
3. ãƒãƒ¼ãƒ ã‚’ä½œæˆ

### ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª
ãƒãƒ¼ãƒ ã§å¤§ä¼šã«å‚åŠ ã—ã€å‚åŠ çŠ¶æ³ãŒæ­£ã—ãè¨˜éŒ²ã•ã‚Œã‚‹

### æ‰‹é †

#### ã‚¹ãƒ†ãƒƒãƒ—1: æ‰€å±ãƒãƒ¼ãƒ ã‚’ç¢ºèª
ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§å®Ÿè¡Œï¼š
```javascript
const user = JSON.parse(localStorage.getItem('user'));
const response = await fetch(`/api/railway-teams/my-teams?user_id=${user.id}`);
const teams = await response.json();
console.log('æ‰€å±ãƒãƒ¼ãƒ :', teams);
console.table(teams.map(t => ({
  ID: t.id,
  ãƒãƒ¼ãƒ å: t.name,
  å½¹å‰²: t.user_role,
  ãƒ¡ãƒ³ãƒãƒ¼æ•°: t.member_count
})));

// æœ€åˆã®ãƒãƒ¼ãƒ IDã‚’ä¿å­˜
const myTeamId = teams[0]?.id;
console.log('ä½¿ç”¨ã™ã‚‹ãƒãƒ¼ãƒ ID:', myTeamId);
```

#### ã‚¹ãƒ†ãƒƒãƒ—2: å¤§ä¼šä¸€è¦§ã‹ã‚‰å‚åŠ ã™ã‚‹å¤§ä¼šã‚’é¸æŠ
1. ã€Œã•ãŒã™ã€ã¾ãŸã¯å¤§ä¼šä¸€è¦§ç”»é¢ã«ç§»å‹•
2. å‚åŠ ã—ãŸã„å¤§ä¼šã‚’ã‚¯ãƒªãƒƒã‚¯
3. ã€Œå‚åŠ ã™ã‚‹ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

#### ã‚¹ãƒ†ãƒƒãƒ—3: ãƒãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã§å‚åŠ 
ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§å®Ÿè¡Œï¼ˆã¾ãŸã¯ç”»é¢ã‹ã‚‰æ“ä½œï¼‰ï¼š
```javascript
// å¤§ä¼šè©³ç´°ç”»é¢ã®URLã‹ã‚‰å¤§ä¼šIDã‚’å–å¾—ï¼ˆä¾‹: /tournament-detail/xxx ã® xxxï¼‰
const tournamentId = 'ã“ã“ã«å¤§ä¼šIDã‚’å…¥åŠ›';
const myTeamId = 'ã“ã“ã«ãƒãƒ¼ãƒ IDã‚’å…¥åŠ›'; // ã‚¹ãƒ†ãƒƒãƒ—1ã§ç¢ºèªã—ãŸID

const response = await fetch(`/api/railway-tournaments/${tournamentId}/apply`, {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${localStorage.getItem('JWT')}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    mode: 'team',
    team_id: myTeamId
  })
});
const result = await response.json();
console.log('å‚åŠ çµæœ:', result);
```

#### ã‚¹ãƒ†ãƒƒãƒ—4: å‚åŠ çŠ¶æ³ã‚’ç¢ºèª
```javascript
// å‚åŠ æ¸ˆã¿ã‹ç¢ºèª
const checkResponse = await fetch(`/api/railway-tournaments/${tournamentId}/is-participating`, {
  headers: {
    'Authorization': `Bearer ${localStorage.getItem('JWT')}`
  }
});
const status = await checkResponse.json();
console.log('å‚åŠ çŠ¶æ³:', status);
```

### âœ… æˆåŠŸåŸºæº–
- [x] æ‰€å±ãƒãƒ¼ãƒ ãŒæ­£ã—ãå–å¾—ã§ãã‚‹
- [x] ãƒãƒ¼ãƒ ã§å¤§ä¼šã«å‚åŠ ã§ãã‚‹
- [x] å‚åŠ çŠ¶æ³ãŒæ­£ã—ãè¨˜éŒ²ã•ã‚Œã‚‹
- [x] é‡è¤‡å‚åŠ ã¯æ‹’å¦ã•ã‚Œã‚‹

---

## ğŸ¯ ãƒ†ã‚¹ãƒˆ3: å¯¾æˆ¦è¡¨è‡ªå‹•ç”Ÿæˆï¼ˆå®šå“¡åˆ°é”æ™‚ï¼‰

### ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª
å®šå“¡4ãƒãƒ¼ãƒ ã®å¤§ä¼šã«4ãƒãƒ¼ãƒ ãŒå‚åŠ ã™ã‚‹ã¨ã€è‡ªå‹•çš„ã«å¯¾æˆ¦è¡¨ï¼ˆ6è©¦åˆï¼‰ãŒç”Ÿæˆã•ã‚Œã‚‹

### æº–å‚™
1. å®šå“¡4ãƒãƒ¼ãƒ ã®å¤§ä¼šã‚’ä½œæˆï¼ˆãƒ†ã‚¹ãƒˆ1ã‚’å‚ç…§ï¼‰
2. 4ã¤ã®ãƒ†ã‚¹ãƒˆãƒãƒ¼ãƒ /ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ç”¨æ„

### æ‰‹é †

#### ã‚¹ãƒ†ãƒƒãƒ—1: ç¾åœ¨ã®å‚åŠ çŠ¶æ³ã‚’ç¢ºèª
```javascript
const tournamentId = 'ã“ã“ã«å¤§ä¼šIDã‚’å…¥åŠ›';

// å‚åŠ è€…ä¸€è¦§ã‚’å–å¾—
const participantsResp = await fetch(`/api/railway-tournaments/${tournamentId}/participants`);
const participants = await participantsResp.json();
console.log('ç¾åœ¨ã®å‚åŠ è€…æ•°:', participants.length);
console.table(participants.map(p => ({
  ãƒãƒ¼ãƒ å: p.team_name,
  ãƒ¢ãƒ¼ãƒ‰: p.mode,
  çŠ¶æ…‹: p.status
})));
```

#### ã‚¹ãƒ†ãƒƒãƒ—2: 4ãƒãƒ¼ãƒ ç›®ãŒå‚åŠ 
```javascript
// 4ãƒãƒ¼ãƒ ç›®ã¨ã—ã¦å‚åŠ 
const response = await fetch(`/api/railway-tournaments/${tournamentId}/apply`, {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${localStorage.getItem('JWT')}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    mode: 'team',
    team_id: 'ã“ã“ã«4ãƒãƒ¼ãƒ ç›®ã®IDã‚’å…¥åŠ›'
  })
});
const result = await response.json();
console.log('å‚åŠ çµæœ:', result);
console.log('å¯¾æˆ¦è¡¨ç”Ÿæˆãƒ•ãƒ©ã‚°:', result.matches_generated);
```

#### ã‚¹ãƒ†ãƒƒãƒ—3: å¯¾æˆ¦è¡¨ã‚’ç¢ºèª
```javascript
// å¯¾æˆ¦è¡¨ã‚’å–å¾—
const matchesResp = await fetch(`/api/railway-tournaments/${tournamentId}/matches`);
const matches = await matchesResp.json();

console.log('=== å¯¾æˆ¦è¡¨ ===');
console.log('è©¦åˆæ•°:', matches.length);
console.log('æœŸå¾…å€¤: 4ãƒãƒ¼ãƒ ç·å½“ãŸã‚Š = 6è©¦åˆ (4C2)');
console.log('');

matches.forEach((match, index) => {
  console.log(`è©¦åˆ${match.match_number}: ${match.team1_name} vs ${match.team2_name}`);
});

// è¡¨å½¢å¼ã§è¡¨ç¤º
console.table(matches.map(m => ({
  è©¦åˆç•ªå·: m.match_number,
  ãƒãƒ¼ãƒ 1: m.team1_name,
  ãƒãƒ¼ãƒ 2: m.team2_name,
  çŠ¶æ…‹: m.status,
  ãƒ¢ãƒ¼ãƒ‰: m.match_mode
})));
```

#### ã‚¹ãƒ†ãƒƒãƒ—4: ãƒ‡ãƒ¼ã‚¿ã®æ­£ç¢ºæ€§ã‚’æ¤œè¨¼
```javascript
// æ¤œè¨¼é …ç›®
const validation = {
  'è©¦åˆæ•°ãŒ6è©¦åˆ': matches.length === 6,
  'ã™ã¹ã¦ãƒãƒ¼ãƒ æˆ¦': matches.every(m => m.match_mode === 'team'),
  'player_idãŒnull': matches.every(m => !m.player1_id && !m.player2_id),
  'team_idãŒè¨­å®š': matches.every(m => m.team1_id && m.team2_id),
  'è©¦åˆç•ªå·ãŒé€£ç•ª': matches.every((m, i) => m.match_number === i + 1)
};

console.log('=== æ¤œè¨¼çµæœ ===');
Object.entries(validation).forEach(([key, value]) => {
  console.log(`${value ? 'âœ…' : 'âŒ'} ${key}`);
});
```

### âœ… æˆåŠŸåŸºæº–
- [x] 4ãƒãƒ¼ãƒ ç›®ã®å‚åŠ ã§å¯¾æˆ¦è¡¨ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹
- [x] 6è©¦åˆï¼ˆ4C2ï¼‰ãŒç”Ÿæˆã•ã‚Œã‚‹
- [x] ã™ã¹ã¦ãƒãƒ¼ãƒ æˆ¦ï¼ˆteam1_id, team2_id ãŒè¨­å®šï¼‰
- [x] player1_id, player2_id ã¯ null
- [x] è©¦åˆç•ªå·ãŒ1ã‹ã‚‰é€£ç•ª
- [x] ãƒ©ãƒ³ãƒ€ãƒ ã«ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã•ã‚Œã¦ã„ã‚‹

---

## ğŸ“… ãƒ†ã‚¹ãƒˆ4: å¯¾æˆ¦è¡¨è‡ªå‹•ç”Ÿæˆï¼ˆç· åˆ‡æ—¥ï¼‰

### ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª
ç”³è¾¼ç· åˆ‡æ—¥ã‚’éããŸå¤§ä¼šã¯ã€ãƒãƒƒãƒå‡¦ç†ã§è‡ªå‹•çš„ã«å¯¾æˆ¦è¡¨ãŒç”Ÿæˆã•ã‚Œã‚‹

### æº–å‚™
1. ç· åˆ‡æ—¥ãŒéå»ã®å¤§ä¼šã‚’ä½œæˆï¼ˆã¾ãŸã¯æ—¢å­˜å¤§ä¼šã®ç· åˆ‡æ—¥ã‚’éå»ã«å¤‰æ›´ï¼‰

### æ‰‹é †

#### ã‚¹ãƒ†ãƒƒãƒ—1: ãƒ†ã‚¹ãƒˆç”¨å¤§ä¼šã®æº–å‚™
```javascript
// æ–¹æ³•A: æ–°ã—ã„å¤§ä¼šã‚’ä½œæˆï¼ˆç· åˆ‡æ—¥ã‚’æ˜¨æ—¥ã«è¨­å®šï¼‰
// å¤§ä¼šä½œæˆç”»é¢ã§å®Ÿæ–½

// æ–¹æ³•B: æ—¢å­˜å¤§ä¼šã®ç· åˆ‡æ—¥ã‚’å¤‰æ›´ï¼ˆCloudflare D1ã§ç›´æ¥å®Ÿè¡Œï¼‰
// UPDATE tournaments 
// SET registration_deadline = date('now', '-1 day')
// WHERE id = 'your-tournament-id';
```

#### ã‚¹ãƒ†ãƒƒãƒ—2: 2ãƒãƒ¼ãƒ ä»¥ä¸Šå‚åŠ ã•ã›ã‚‹
```javascript
// ãƒ†ã‚¹ãƒˆ1, 2ã®æ‰‹é †ã§2ãƒãƒ¼ãƒ ä»¥ä¸Šå‚åŠ 
```

#### ã‚¹ãƒ†ãƒƒãƒ—3: ãƒãƒƒãƒå‡¦ç†ã‚’å®Ÿè¡Œ
```javascript
const response = await fetch('/api/railway-tournaments/auto-generate-matches', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  }
});
const result = await response.json();

console.log('=== ãƒãƒƒãƒå‡¦ç†çµæœ ===');
console.log('å‡¦ç†æˆåŠŸ:', result.success);
console.log('å‡¦ç†ã—ãŸå¤§ä¼šæ•°:', result.processed);
console.log('');
console.log('å¤§ä¼šè©³ç´°:');
console.table(result.tournaments?.map(t => ({
  å¤§ä¼šå: t.tournament_name,
  å‚åŠ è€…æ•°: t.participants,
  ç”Ÿæˆè©¦åˆæ•°: t.matches_created
})));
```

#### ã‚¹ãƒ†ãƒƒãƒ—4: å¯¾æˆ¦è¡¨ã‚’ç¢ºèª
```javascript
const tournamentId = result.tournaments[0]?.tournament_id;
if (tournamentId) {
  const matchesResp = await fetch(`/api/railway-tournaments/${tournamentId}/matches`);
  const matches = await matchesResp.json();
  console.log('å¯¾æˆ¦è¡¨:', matches);
}
```

### âœ… æˆåŠŸåŸºæº–
- [x] ç· åˆ‡æ—¥ã‚’éããŸå¤§ä¼šãŒå‡¦ç†ã•ã‚Œã‚‹
- [x] 2ãƒãƒ¼ãƒ ä»¥ä¸Šã§å¯¾æˆ¦è¡¨ãŒç”Ÿæˆã•ã‚Œã‚‹
- [x] ãƒãƒƒãƒå‡¦ç†ã®çµæœãŒæ­£ã—ãè¿”ã•ã‚Œã‚‹
- [x] ç”Ÿæˆã•ã‚ŒãŸè©¦åˆæ•°ãŒæ­£ã—ã„ï¼ˆnC2ï¼‰

---

## ğŸ”” ãƒ†ã‚¹ãƒˆ5: é–‹å‚¬å‰æ—¥ã®é€šçŸ¥æ©Ÿèƒ½

### ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª
å¤§ä¼šé–‹å‚¬ã®å‰æ—¥ã«ã€å‚åŠ è€…å…¨å“¡ï¼ˆãƒãƒ¼ãƒ ã®å ´åˆã¯å…¨ãƒ¡ãƒ³ãƒãƒ¼ï¼‰ã«å¯¾æˆ¦è¡¨ç™ºè¡¨ã®é€šçŸ¥ãŒé€ä¿¡ã•ã‚Œã‚‹

### æº–å‚™
1. å¯¾æˆ¦è¡¨ãŒç”Ÿæˆæ¸ˆã¿ã®å¤§ä¼šï¼ˆãƒ†ã‚¹ãƒˆ3ã¾ãŸã¯4ã§ä½œæˆï¼‰
2. é–‹å‚¬æ—¥ã®è¨­å®šã‚’ç¢ºèª

### æ‰‹é †

#### ã‚¹ãƒ†ãƒƒãƒ—1: é€šçŸ¥ãŒä½œæˆã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

**æ³¨æ„**: é€šçŸ¥ã¯é–‹å‚¬æ—¥ã®1æ—¥å‰ã«ä½œæˆã•ã‚Œã¾ã™ã€‚ãƒ†ã‚¹ãƒˆã®ãŸã‚ã€created_atã‚’ç¾åœ¨æ™‚åˆ»ã«å¤‰æ›´ã—ã¾ã™ã€‚

**Cloudflare D1 Consoleã§å®Ÿè¡Œ**:
```sql
-- 1. é€šçŸ¥ã‚’ç¢ºèª
SELECT 
  n.id,
  n.type,
  n.title,
  n.created_at,
  n.tournament_id,
  p.username
FROM notifications n
LEFT JOIN profiles p ON n.user_id = p.id
WHERE n.type = 'match_schedule'
ORDER BY n.created_at DESC
LIMIT 10;

-- 2. ãƒ†ã‚¹ãƒˆç”¨ã«é€šçŸ¥æ—¥æ™‚ã‚’ç¾åœ¨ã«å¤‰æ›´
UPDATE notifications
SET created_at = datetime('now')
WHERE type = 'match_schedule'
AND tournament_id = 'your-tournament-id';
```

#### ã‚¹ãƒ†ãƒƒãƒ—2: ã‚¢ãƒ—ãƒªã§é€šçŸ¥ã‚’ç¢ºèª
1. é€šçŸ¥ï¼ˆãŠçŸ¥ã‚‰ã›ï¼‰ç”»é¢ã«ç§»å‹•
2. ã€Œå¯¾æˆ¦è¡¨ç™ºè¡¨ã€ã®é€šçŸ¥ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

#### ã‚¹ãƒ†ãƒƒãƒ—3: ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§é€šçŸ¥ã‚’å–å¾—
```javascript
const response = await fetch('/api/railway-notifications', {
  headers: {
    'Authorization': `Bearer ${localStorage.getItem('JWT')}`
  }
});
const notifications = await response.json();

// å¤§ä¼šé–¢é€£ã®é€šçŸ¥ã‚’ãƒ•ã‚£ãƒ«ã‚¿
const tournamentNotifs = notifications.filter(n =>
  n.type === 'match_schedule' || n.type === 'tournament_reminder'
);

console.log('=== å¤§ä¼šé–¢é€£é€šçŸ¥ ===');
console.table(tournamentNotifs.map(n => ({
  ã‚¿ã‚¤ãƒ—: n.type,
  ã‚¿ã‚¤ãƒˆãƒ«: n.title,
  ä½œæˆæ—¥æ™‚: new Date(n.created_at).toLocaleString('ja-JP'),
  æ—¢èª­: n.read ? 'æ—¢èª­' : 'æœªèª­'
})));

// æœ€æ–°ã®é€šçŸ¥å†…å®¹ã‚’è¡¨ç¤º
if (tournamentNotifs.length > 0) {
  const latestNotif = tournamentNotifs[0];
  console.log('=== æœ€æ–°ã®é€šçŸ¥å†…å®¹ ===');
  console.log('ã‚¿ã‚¤ãƒˆãƒ«:', latestNotif.title);
  console.log('å†…å®¹:');
  console.log(latestNotif.content);
}
```

#### ã‚¹ãƒ†ãƒƒãƒ—4: é€šçŸ¥å†…å®¹ã®ç¢ºèª
é€šçŸ¥ã«ã¯ä»¥ä¸‹ã®æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªï¼š
- âœ… å¤§ä¼šå
- âœ… é–‹å‚¬æ—¥
- âœ… é–‹å‚¬å ´æ‰€
- âœ… å¯¾æˆ¦è¡¨ã®è©¦åˆæ•°
- âœ… ã€Œæ˜æ—¥é–‹å‚¬ã•ã‚Œã¾ã™ã€ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

### âœ… æˆåŠŸåŸºæº–
- [x] é–‹å‚¬å‰æ—¥ã«é€šçŸ¥ãŒä½œæˆã•ã‚Œã‚‹
- [x] å‚åŠ è€…å…¨å“¡ã«é€šçŸ¥ãŒå±Šã
- [x] ãƒãƒ¼ãƒ å‚åŠ ã®å ´åˆã€ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼å…¨å“¡ã«é€šçŸ¥
- [x] é€šçŸ¥å†…å®¹ãŒæ­£ã—ã„ï¼ˆå¤§ä¼šåã€æ—¥æ™‚ã€å ´æ‰€ã€è©¦åˆæ•°ï¼‰
- [x] é€šçŸ¥ç”»é¢ã«ã€Œå¯¾æˆ¦è¡¨ç™ºè¡¨ã€ãƒ©ãƒ™ãƒ«ã§è¡¨ç¤ºã•ã‚Œã‚‹
- [x] ã‚¯ãƒªãƒƒã‚¯ã§æ—¢èª­ã«ãªã‚‹

---

## ğŸ”„ ãƒ†ã‚¹ãƒˆ6: å¯¾æˆ¦è¡¨ã®ãƒ©ãƒ³ãƒ€ãƒ æ€§

### ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª
åŒã˜ãƒãƒ¼ãƒ ã§ã‚‚ã€å¤§ä¼šã”ã¨ã«å¯¾æˆ¦é †ãŒãƒ©ãƒ³ãƒ€ãƒ ã«ãªã‚‹ã“ã¨ã‚’ç¢ºèª

### æ‰‹é †

#### ã‚¹ãƒ†ãƒƒãƒ—1: è¤‡æ•°ã®å¤§ä¼šã‚’ä½œæˆ
1. åŒã˜è¨­å®šã§3ã¤ã®å¤§ä¼šã‚’ä½œæˆ
2. åŒã˜4ãƒãƒ¼ãƒ ã§å‚åŠ 

#### ã‚¹ãƒ†ãƒƒãƒ—2: å¯¾æˆ¦è¡¨ã‚’æ¯”è¼ƒ
```javascript
const tournament1 = 'tournament-id-1';
const tournament2 = 'tournament-id-2';
const tournament3 = 'tournament-id-3';

// å„å¤§ä¼šã®å¯¾æˆ¦è¡¨ã‚’å–å¾—
const matches1 = await (await fetch(`/api/railway-tournaments/${tournament1}/matches`)).json();
const matches2 = await (await fetch(`/api/railway-tournaments/${tournament2}/matches`)).json();
const matches3 = await (await fetch(`/api/railway-tournaments/${tournament3}/matches`)).json();

console.log('=== å¤§ä¼š1ã®å¯¾æˆ¦é † ===');
matches1.forEach(m => console.log(`${m.match_number}: ${m.team1_name} vs ${m.team2_name}`));

console.log('\n=== å¤§ä¼š2ã®å¯¾æˆ¦é † ===');
matches2.forEach(m => console.log(`${m.match_number}: ${m.team1_name} vs ${m.team2_name}`));

console.log('\n=== å¤§ä¼š3ã®å¯¾æˆ¦é † ===');
matches3.forEach(m => console.log(`${m.match_number}: ${m.team1_name} vs ${m.team2_name}`));

// æœ€åˆã®è©¦åˆãŒç•°ãªã‚‹ã‹ç¢ºèª
const firstMatches = [
  `${matches1[0].team1_name} vs ${matches1[0].team2_name}`,
  `${matches2[0].team1_name} vs ${matches2[0].team2_name}`,
  `${matches3[0].team1_name} vs ${matches3[0].team2_name}`
];

console.log('\n=== ãƒ©ãƒ³ãƒ€ãƒ æ€§ã®ç¢ºèª ===');
console.log('å„å¤§ä¼šã®æœ€åˆã®è©¦åˆ:', firstMatches);
const allSame = firstMatches[0] === firstMatches[1] && firstMatches[1] === firstMatches[2];
console.log(allSame ? 'âŒ ã™ã¹ã¦åŒã˜ï¼ˆãƒ©ãƒ³ãƒ€ãƒ ã§ã¯ãªã„ï¼‰' : 'âœ… ç•°ãªã‚‹å¯¾æˆ¦é †ï¼ˆãƒ©ãƒ³ãƒ€ãƒ ï¼‰');
```

### âœ… æˆåŠŸåŸºæº–
- [x] åŒã˜ãƒãƒ¼ãƒ ã§ã‚‚å¯¾æˆ¦é †ãŒç•°ãªã‚‹
- [x] Fisher-Yatesã‚·ãƒ£ãƒƒãƒ•ãƒ«ãŒæ©Ÿèƒ½ã—ã¦ã„ã‚‹
- [x] å¯¾æˆ¦çµ„ã¿åˆã‚ã›è‡ªä½“ã¯åŒã˜ï¼ˆç·å½“ãŸã‚Šï¼‰ã ãŒé †ç•ªãŒç•°ãªã‚‹

---

## ğŸ” ãƒ‡ãƒãƒƒã‚°ç”¨SQLã‚¯ã‚¨ãƒª

### Cloudflare D1 Consoleã§ã®ç¢ºèª

#### å¤§ä¼šæƒ…å ±
```sql
SELECT 
  id,
  name,
  start_date,
  location,
  max_participants,
  registration_deadline,
  status,
  created_at
FROM tournaments
ORDER BY created_at DESC
LIMIT 10;
```

#### å¤§ä¼šå‚åŠ è€…
```sql
SELECT 
  tp.tournament_id,
  t.name as tournament_name,
  tp.mode,
  CASE 
    WHEN tp.mode = 'team' THEN tm.name
    ELSE p.username
  END as participant_name,
  tp.status
FROM tournament_participants tp
LEFT JOIN tournaments t ON tp.tournament_id = t.id
LEFT JOIN teams tm ON tp.team_id = tm.id
LEFT JOIN profiles p ON tp.user_id = p.id
WHERE tp.tournament_id = 'your-tournament-id'
ORDER BY tp.created_at;
```

#### å¯¾æˆ¦è¡¨
```sql
SELECT 
  tm.tournament_id,
  t.name as tournament_name,
  tm.match_number,
  tm.match_mode,
  t1.name as team1,
  t2.name as team2,
  tm.status
FROM tournament_matches tm
LEFT JOIN tournaments t ON tm.tournament_id = t.id
LEFT JOIN teams t1 ON tm.team1_id = t1.id
LEFT JOIN teams t2 ON tm.team2_id = t2.id
WHERE tm.tournament_id = 'your-tournament-id'
ORDER BY tm.match_number;
```

#### é€šçŸ¥
```sql
SELECT 
  n.id,
  n.type,
  n.title,
  n.tournament_id,
  n.created_at,
  n.read,
  p.username
FROM notifications n
LEFT JOIN profiles p ON n.user_id = p.id
WHERE n.type IN ('match_schedule', 'tournament_reminder')
ORDER BY n.created_at DESC
LIMIT 20;
```

#### ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼
```sql
SELECT 
  tm.team_id,
  t.name as team_name,
  tm.user_id,
  p.username,
  tm.role,
  tm.status
FROM team_members tm
LEFT JOIN teams t ON tm.team_id = t.id
LEFT JOIN profiles p ON tm.user_id = p.id
WHERE tm.team_id = 'your-team-id';
```

---

## â“ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### å•é¡Œ1: ãƒãƒ¼ãƒ ä¸€è¦§ãŒç©º
**åŸå› **: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒãƒ¼ãƒ ã«å‚åŠ ã—ã¦ã„ãªã„
**è§£æ±ºç­–**:
1. ãƒãƒ¼ãƒ ä½œæˆç”»é¢ã§ãƒãƒ¼ãƒ ã‚’ä½œæˆ
2. ã¾ãŸã¯æ—¢å­˜ãƒãƒ¼ãƒ ã«å‚åŠ 

### å•é¡Œ2: å¯¾æˆ¦è¡¨ãŒç”Ÿæˆã•ã‚Œãªã„
**åŸå› **:
- å‚åŠ è€…ãŒ2ãƒãƒ¼ãƒ æœªæº€
- å€‹äººå‚åŠ è€…ãŒæ··åœ¨ã—ã¦ã„ã‚‹ï¼ˆç¾åœ¨ã¯ãƒãƒ¼ãƒ ã®ã¿å¯¾å¿œï¼‰

**è§£æ±ºç­–**:
1. 2ãƒãƒ¼ãƒ ä»¥ä¸ŠãŒå‚åŠ ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
2. ã™ã¹ã¦ãƒãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã§å‚åŠ ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª

### å•é¡Œ3: é€šçŸ¥ãŒè¡¨ç¤ºã•ã‚Œãªã„
**åŸå› **: `created_at` ãŒæœªæ¥ã®æ—¥æ™‚ã«ãªã£ã¦ã„ã‚‹
**è§£æ±ºç­–**:
- D1 Consoleã§ `created_at` ã‚’ç¾åœ¨æ™‚åˆ»ã«å¤‰æ›´
- ã¾ãŸã¯å®Ÿéš›ã®é–‹å‚¬å‰æ—¥ã¾ã§å¾…ã¤

### å•é¡Œ4: "Authorization header missing"ã‚¨ãƒ©ãƒ¼
**åŸå› **: JWTãƒˆãƒ¼ã‚¯ãƒ³ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„
**è§£æ±ºç­–**:
```javascript
// ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã‚’ç¢ºèª
const jwt = localStorage.getItem('JWT');
console.log('JWTå­˜åœ¨:', !!jwt);

// JWTãŒãªã„å ´åˆã¯å†ãƒ­ã‚°ã‚¤ãƒ³
if (!jwt) {
  alert('å†åº¦ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„');
  window.location.href = '/login';
}
```

### å•é¡Œ5: CORS ã‚¨ãƒ©ãƒ¼
**åŸå› **: æœ¬ç•ªç’°å¢ƒã®CORSè¨­å®š
**è§£æ±ºç­–**:
- ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰ã§ã¯ãªãã€ã‚¢ãƒ—ãƒªã®UIçµŒç”±ã§æ“ä½œ
- ã¾ãŸã¯ `wrangler.toml` ã®CORSè¨­å®šã‚’ç¢ºèª

---

## ğŸ“Š ãƒ†ã‚¹ãƒˆå®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### å¤§ä¼šé–‹å‚¬æ©Ÿèƒ½
- [ ] å¤§ä¼šã‚’ä½œæˆã§ãã‚‹
- [ ] ä½œæˆã—ãŸå¤§ä¼šãŒä¸€è¦§ã«è¡¨ç¤ºã•ã‚Œã‚‹
- [ ] å¤§ä¼šæƒ…å ±ãŒæ­£ã—ãä¿å­˜ã•ã‚Œã‚‹

### ãƒãƒ¼ãƒ å‚åŠ æ©Ÿèƒ½
- [ ] æ‰€å±ãƒãƒ¼ãƒ ã‚’å–å¾—ã§ãã‚‹
- [ ] ãƒãƒ¼ãƒ ã§å¤§ä¼šã«å‚åŠ ã§ãã‚‹
- [ ] å‚åŠ çŠ¶æ³ãŒæ­£ã—ãè¨˜éŒ²ã•ã‚Œã‚‹
- [ ] é‡è¤‡å‚åŠ ãŒé˜²æ­¢ã•ã‚Œã‚‹

### å¯¾æˆ¦è¡¨è‡ªå‹•ç”Ÿæˆï¼ˆå®šå“¡ï¼‰
- [ ] å®šå“¡åˆ°é”ã§è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹
- [ ] æ­£ã—ã„è©¦åˆæ•°ãŒç”Ÿæˆã•ã‚Œã‚‹ï¼ˆnC2ï¼‰
- [ ] ãƒãƒ¼ãƒ æˆ¦ã¨ã—ã¦è¨˜éŒ²ã•ã‚Œã‚‹
- [ ] ãƒ©ãƒ³ãƒ€ãƒ ã«ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã•ã‚Œã‚‹

### å¯¾æˆ¦è¡¨è‡ªå‹•ç”Ÿæˆï¼ˆç· åˆ‡ï¼‰
- [ ] ç· åˆ‡æ—¥ã‚’éããŸå¤§ä¼šãŒå‡¦ç†ã•ã‚Œã‚‹
- [ ] ãƒãƒƒãƒå‡¦ç†ãŒæ­£å¸¸ã«å®Ÿè¡Œã•ã‚Œã‚‹
- [ ] å¯¾æˆ¦è¡¨ãŒç”Ÿæˆã•ã‚Œã‚‹

### é€šçŸ¥æ©Ÿèƒ½
- [ ] é–‹å‚¬å‰æ—¥ã«é€šçŸ¥ãŒä½œæˆã•ã‚Œã‚‹
- [ ] å‚åŠ è€…å…¨å“¡ã«é€šçŸ¥ãŒå±Šã
- [ ] ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼å…¨å“¡ã«é€šçŸ¥ãŒå±Šã
- [ ] é€šçŸ¥å†…å®¹ãŒæ­£ã—ã„
- [ ] é€šçŸ¥ç”»é¢ã«è¡¨ç¤ºã•ã‚Œã‚‹
- [ ] æ—¢èª­å‡¦ç†ãŒå‹•ä½œã™ã‚‹

### ãƒ©ãƒ³ãƒ€ãƒ æ€§
- [ ] å¯¾æˆ¦é †ãŒãƒ©ãƒ³ãƒ€ãƒ ã«ãªã‚‹
- [ ] åŒã˜ãƒãƒ¼ãƒ ã§ã‚‚ç•°ãªã‚‹é †ç•ª

---

## ğŸ“ ãƒ†ã‚¹ãƒˆçµæœã®è¨˜éŒ²

ãƒ†ã‚¹ãƒˆå®Ÿè¡Œå¾Œã€ä»¥ä¸‹ã®å½¢å¼ã§çµæœã‚’è¨˜éŒ²ã—ã¦ãã ã•ã„ï¼š

```
ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ—¥: 2025å¹´11æœˆ29æ—¥
ãƒ†ã‚¹ãƒˆç’°å¢ƒ: æœ¬ç•ªç’°å¢ƒ (https://1a43afb3.sofvo.pages.dev)
ãƒ†ã‚¹ãƒˆå®Ÿæ–½è€…: [åå‰]

ã€çµæœã‚µãƒãƒªãƒ¼ã€‘
- å¤§ä¼šé–‹å‚¬: âœ… / âŒ
- ãƒãƒ¼ãƒ å‚åŠ : âœ… / âŒ
- å¯¾æˆ¦è¡¨ç”Ÿæˆï¼ˆå®šå“¡ï¼‰: âœ… / âŒ
- å¯¾æˆ¦è¡¨ç”Ÿæˆï¼ˆç· åˆ‡ï¼‰: âœ… / âŒ
- é€šçŸ¥æ©Ÿèƒ½: âœ… / âŒ
- ãƒ©ãƒ³ãƒ€ãƒ æ€§: âœ… / âŒ

ã€ç™ºè¦‹ã—ãŸå•é¡Œã€‘
1. ...
2. ...

ã€ã‚³ãƒ¡ãƒ³ãƒˆã€‘
...
```

---

## ğŸ¯ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

ãƒ†ã‚¹ãƒˆå®Œäº†å¾Œï¼š
1. âœ… ã™ã¹ã¦ã®æ©Ÿèƒ½ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
2. ğŸ“ ãƒ†ã‚¹ãƒˆçµæœã‚’ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–
3. ğŸ› ç™ºè¦‹ã—ãŸãƒã‚°ã‚’ä¿®æ­£
4. ğŸš€ æœ¬ç•ªç’°å¢ƒã§ã®å®Ÿé‹ç”¨é–‹å§‹
5. ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–ã¨ãƒ­ã‚°ç¢ºèª

---

**æº–å‚™å®Œäº†ï¼ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹ã—ã¾ã—ã‚‡ã†ï¼** ğŸš€

